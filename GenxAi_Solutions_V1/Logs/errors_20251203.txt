[2025-12-03 12:55:07.671] [Error]
Category: GenxAi_Solutions_V1.Services.AuthEventsService
Message: JWT authentication failed on /api/auth/login
Exception Type: Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException
Exception Message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '12/2/2025 6:19:37 AM', Current time (UTC): '12/3/2025 7:25:07 AM'.
Stack Trace:    at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
--------------------------------------------------------------------------------
[2025-12-03 12:55:07.783] [Error]
Category: GenxAi_Solutions_V1.Services.AuthEventsService
Message: JWT authentication failed on /api/auth/login
Exception Type: Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException
Exception Message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '12/2/2025 6:19:37 AM', Current time (UTC): '12/3/2025 7:25:07 AM'.
Stack Trace:    at Microsoft.IdentityModel.Tokens.ValidatorUtilities.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
--------------------------------------------------------------------------------
[2025-12-03 12:55:50.376] [Error]
Category: GenxAi_Solutions_V1.Api.ChatBotController
Message: QuerySqlWithAgent failed after 6843ms - ConversationId=51652, Message=hi
Exception Type: System.ClientModel.ClientResultException
Exception Message: HTTP 401 (invalid_request_error: invalid_api_key)

Incorrect API key provided: sk-proj-********************************************************************************************************************************************************JZYA. You can find your API key at https://platform.openai.com/account/api-keys.
Stack Trace:    at OpenAI.ClientPipelineExtensions.ProcessMessageAsync(ClientPipeline pipeline, PipelineMessage message, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(BinaryContent content, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(IEnumerable`1 messages, ChatCompletionOptions options, RequestOptions requestOptions)
   at Microsoft.Extensions.AI.OpenAIChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Extensions.AI.FunctionInvokingChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at GenxAi_Solutions_V1.Api.ChatBotController.HandleGreetingResponse(String message, Int64 convId, Int32 companyId, SqlVectorStores stores, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1962
   at GenxAi_Solutions_V1.Api.ChatBotController.QuerySqlWithAgent(String message, String dbPathSql, String connStr, String databaseName, String dbType, Int64 convId, Int32 companyId, Int32 userId, Boolean wantsChart, Boolean sqlGreets, Int64 userMsgId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1011
--------------------------------------------------------------------------------
[2025-12-03 12:55:50.404] [Error]
Category: GenxAi_Solutions_V1.Api.ChatBotController
Message: QuerySqlWithAgent failed after 6843ms - ConversationId=51652, Message=hi
Exception Type: System.ClientModel.ClientResultException
Exception Message: HTTP 401 (invalid_request_error: invalid_api_key)

Incorrect API key provided: sk-proj-********************************************************************************************************************************************************JZYA. You can find your API key at https://platform.openai.com/account/api-keys.
Stack Trace:    at OpenAI.ClientPipelineExtensions.ProcessMessageAsync(ClientPipeline pipeline, PipelineMessage message, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(BinaryContent content, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(IEnumerable`1 messages, ChatCompletionOptions options, RequestOptions requestOptions)
   at Microsoft.Extensions.AI.OpenAIChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Extensions.AI.FunctionInvokingChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at GenxAi_Solutions_V1.Api.ChatBotController.HandleGreetingResponse(String message, Int64 convId, Int32 companyId, SqlVectorStores stores, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1962
   at GenxAi_Solutions_V1.Api.ChatBotController.QuerySqlWithAgent(String message, String dbPathSql, String connStr, String databaseName, String dbType, Int64 convId, Int32 companyId, Int32 userId, Boolean wantsChart, Boolean sqlGreets, Int64 userMsgId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1011
--------------------------------------------------------------------------------
[2025-12-03 12:55:50.990] [Error]
Category: GenxAi_Solutions_V1.Api.ChatBotController
Message: Error in AskAgent API - User: nidhi.lad@genxai.com, Service: SQLAnalytics, Message: hi, CorrelationId: d7305f0e-8b34-4306-bdfe-e51d114948db, Error: HTTP 401 (invalid_request_error: invalid_api_key)

Incorrect API key provided: sk-proj-********************************************************************************************************************************************************JZYA. You can find your API key at https://platform.openai.com/account/api-keys.
Exception Type: System.ClientModel.ClientResultException
Exception Message: HTTP 401 (invalid_request_error: invalid_api_key)

Incorrect API key provided: sk-proj-********************************************************************************************************************************************************JZYA. You can find your API key at https://platform.openai.com/account/api-keys.
Stack Trace:    at OpenAI.ClientPipelineExtensions.ProcessMessageAsync(ClientPipeline pipeline, PipelineMessage message, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(BinaryContent content, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(IEnumerable`1 messages, ChatCompletionOptions options, RequestOptions requestOptions)
   at Microsoft.Extensions.AI.OpenAIChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Extensions.AI.FunctionInvokingChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at GenxAi_Solutions_V1.Api.ChatBotController.HandleGreetingResponse(String message, Int64 convId, Int32 companyId, SqlVectorStores stores, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1962
   at GenxAi_Solutions_V1.Api.ChatBotController.QuerySqlWithAgent(String message, String dbPathSql, String connStr, String databaseName, String dbType, Int64 convId, Int32 companyId, Int32 userId, Boolean wantsChart, Boolean sqlGreets, Int64 userMsgId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1011
   at GenxAi_Solutions_V1.Api.ChatBotController.AskAgent(String message, String service, Nullable`1 conversationId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 180
--------------------------------------------------------------------------------
[2025-12-03 12:55:50.994] [Error]
Category: GenxAi_Solutions_V1.Api.ChatBotController
Message: Error in AskAgent API - User: nidhi.lad@genxai.com, Service: SQLAnalytics, Message: hi, CorrelationId: d7305f0e-8b34-4306-bdfe-e51d114948db, Error: HTTP 401 (invalid_request_error: invalid_api_key)

Incorrect API key provided: sk-proj-********************************************************************************************************************************************************JZYA. You can find your API key at https://platform.openai.com/account/api-keys.
Exception Type: System.ClientModel.ClientResultException
Exception Message: HTTP 401 (invalid_request_error: invalid_api_key)

Incorrect API key provided: sk-proj-********************************************************************************************************************************************************JZYA. You can find your API key at https://platform.openai.com/account/api-keys.
Stack Trace:    at OpenAI.ClientPipelineExtensions.ProcessMessageAsync(ClientPipeline pipeline, PipelineMessage message, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(BinaryContent content, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(IEnumerable`1 messages, ChatCompletionOptions options, RequestOptions requestOptions)
   at Microsoft.Extensions.AI.OpenAIChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Extensions.AI.FunctionInvokingChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at GenxAi_Solutions_V1.Api.ChatBotController.HandleGreetingResponse(String message, Int64 convId, Int32 companyId, SqlVectorStores stores, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1962
   at GenxAi_Solutions_V1.Api.ChatBotController.QuerySqlWithAgent(String message, String dbPathSql, String connStr, String databaseName, String dbType, Int64 convId, Int32 companyId, Int32 userId, Boolean wantsChart, Boolean sqlGreets, Int64 userMsgId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1011
   at GenxAi_Solutions_V1.Api.ChatBotController.AskAgent(String message, String service, Nullable`1 conversationId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 180
--------------------------------------------------------------------------------
[2025-12-03 12:55:51.949] [Error]
Category: GenxAi_Solutions_V1.Utils.Middleware.ErrorHandlingMiddleware
Message: Unhandled exception POST /api/chat/AskAgent d7305f0e-8b34-4306-bdfe-e51d114948db. Exception Details: System.ClientModel.ClientResultException - HTTP 401 (invalid_request_error: invalid_api_key)

Incorrect API key provided: sk-proj-********************************************************************************************************************************************************JZYA. You can find your API key at https://platform.openai.com/account/api-keys. Stack Trace:    at OpenAI.ClientPipelineExtensions.ProcessMessageAsync(ClientPipeline pipeline, PipelineMessage message, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(BinaryContent content, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(IEnumerable`1 messages, ChatCompletionOptions options, RequestOptions requestOptions)
   at Microsoft.Extensions.AI.OpenAIChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Extensions.AI.FunctionInvokingChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at GenxAi_Solutions_V1.Api.ChatBotController.HandleGreetingResponse(String message, Int64 convId, Int32 companyId, SqlVectorStores stores, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1962
   at GenxAi_Solutions_V1.Api.ChatBotController.QuerySqlWithAgent(String message, String dbPathSql, String connStr, String databaseName, String dbType, Int64 convId, Int32 companyId, Int32 userId, Boolean wantsChart, Boolean sqlGreets, Int64 userMsgId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1011
   at GenxAi_Solutions_V1.Api.ChatBotController.AskAgent(String message, String service, Nullable`1 conversationId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 180
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at GenxAi_Solutions_V1.Utils.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext context) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Utils\Middleware\ErrorHandlingMiddleware.cs:line 139
Exception Type: System.ClientModel.ClientResultException
Exception Message: HTTP 401 (invalid_request_error: invalid_api_key)

Incorrect API key provided: sk-proj-********************************************************************************************************************************************************JZYA. You can find your API key at https://platform.openai.com/account/api-keys.
Stack Trace:    at OpenAI.ClientPipelineExtensions.ProcessMessageAsync(ClientPipeline pipeline, PipelineMessage message, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(BinaryContent content, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(IEnumerable`1 messages, ChatCompletionOptions options, RequestOptions requestOptions)
   at Microsoft.Extensions.AI.OpenAIChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Extensions.AI.FunctionInvokingChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at GenxAi_Solutions_V1.Api.ChatBotController.HandleGreetingResponse(String message, Int64 convId, Int32 companyId, SqlVectorStores stores, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1962
   at GenxAi_Solutions_V1.Api.ChatBotController.QuerySqlWithAgent(String message, String dbPathSql, String connStr, String databaseName, String dbType, Int64 convId, Int32 companyId, Int32 userId, Boolean wantsChart, Boolean sqlGreets, Int64 userMsgId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1011
   at GenxAi_Solutions_V1.Api.ChatBotController.AskAgent(String message, String service, Nullable`1 conversationId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 180
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at GenxAi_Solutions_V1.Utils.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext context) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Utils\Middleware\ErrorHandlingMiddleware.cs:line 139
--------------------------------------------------------------------------------
[2025-12-03 12:55:51.956] [Error]
Category: GenxAi_Solutions_V1.Utils.Middleware.ErrorHandlingMiddleware
Message: Unhandled exception POST /api/chat/AskAgent d7305f0e-8b34-4306-bdfe-e51d114948db. Exception Details: System.ClientModel.ClientResultException - HTTP 401 (invalid_request_error: invalid_api_key)

Incorrect API key provided: sk-proj-********************************************************************************************************************************************************JZYA. You can find your API key at https://platform.openai.com/account/api-keys. Stack Trace:    at OpenAI.ClientPipelineExtensions.ProcessMessageAsync(ClientPipeline pipeline, PipelineMessage message, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(BinaryContent content, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(IEnumerable`1 messages, ChatCompletionOptions options, RequestOptions requestOptions)
   at Microsoft.Extensions.AI.OpenAIChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Extensions.AI.FunctionInvokingChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at GenxAi_Solutions_V1.Api.ChatBotController.HandleGreetingResponse(String message, Int64 convId, Int32 companyId, SqlVectorStores stores, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1962
   at GenxAi_Solutions_V1.Api.ChatBotController.QuerySqlWithAgent(String message, String dbPathSql, String connStr, String databaseName, String dbType, Int64 convId, Int32 companyId, Int32 userId, Boolean wantsChart, Boolean sqlGreets, Int64 userMsgId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1011
   at GenxAi_Solutions_V1.Api.ChatBotController.AskAgent(String message, String service, Nullable`1 conversationId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 180
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at GenxAi_Solutions_V1.Utils.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext context) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Utils\Middleware\ErrorHandlingMiddleware.cs:line 139
Exception Type: System.ClientModel.ClientResultException
Exception Message: HTTP 401 (invalid_request_error: invalid_api_key)

Incorrect API key provided: sk-proj-********************************************************************************************************************************************************JZYA. You can find your API key at https://platform.openai.com/account/api-keys.
Stack Trace:    at OpenAI.ClientPipelineExtensions.ProcessMessageAsync(ClientPipeline pipeline, PipelineMessage message, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(BinaryContent content, RequestOptions options)
   at OpenAI.Chat.ChatClient.CompleteChatAsync(IEnumerable`1 messages, ChatCompletionOptions options, RequestOptions requestOptions)
   at Microsoft.Extensions.AI.OpenAIChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Extensions.AI.FunctionInvokingChatClient.GetResponseAsync(IEnumerable`1 messages, ChatOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at Microsoft.Agents.AI.ChatClientAgent.RunCoreAsync[TAgentRunResponse,TChatClientResponse](Func`5 chatClientRunFunc, Func`2 agentResponseFactoryFunc, IEnumerable`1 messages, AgentThread thread, AgentRunOptions options, CancellationToken cancellationToken)
   at GenxAi_Solutions_V1.Api.ChatBotController.HandleGreetingResponse(String message, Int64 convId, Int32 companyId, SqlVectorStores stores, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1962
   at GenxAi_Solutions_V1.Api.ChatBotController.QuerySqlWithAgent(String message, String dbPathSql, String connStr, String databaseName, String dbType, Int64 convId, Int32 companyId, Int32 userId, Boolean wantsChart, Boolean sqlGreets, Int64 userMsgId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 1011
   at GenxAi_Solutions_V1.Api.ChatBotController.AskAgent(String message, String service, Nullable`1 conversationId, CancellationToken ct) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Api\ChatBotController.cs:line 180
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Awaited|17_0(ResourceInvoker invoker, Task task, IDisposable scope)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at GenxAi_Solutions_V1.Utils.Middleware.ErrorHandlingMiddleware.Invoke(HttpContext context) in D:\GIT_Repos\Research\New folder\MyProject\GenxAi_Solutions_V1\Utils\Middleware\ErrorHandlingMiddleware.cs:line 139
--------------------------------------------------------------------------------
